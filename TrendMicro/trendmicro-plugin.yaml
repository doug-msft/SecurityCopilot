Descriptor:
  Name: TrendMicroVisionOne
  DisplayName: Trend Micro
  Description: "Trend Micro Vision One integration for Security Copilot"
  DescriptionDisplay: "Retrieve alerts and endpoint data from Trend Micro Vision One"
  Icon: "https://w7.pngwing.com/pngs/753/63/png-transparent-trend-micro-internet-security-antivirus-software-malware-computer-security-trend-icon-trademark-computer-logo.png"
  Category: Plugin
  SupportedAuthTypes:
    - ApiKey
  Authorization:
    Type: APIKey
    Key: Authorization
    Location: Header
    AuthScheme: Bearer

SkillGroups:
  - Format: API
    Settings:
      OpenApiSpecUrl: https://raw.githubusercontent.com/doug-msft/SecurityCopilot/main/TrendMicro/trendmicro2-openapi.yaml
      EndpointUrl: https://api.xdr.trendmicro.com
    Skills:
      - Name: GetWorkbenchAlerts
        Description: "Retrieve a list of security alerts from Trend Micro Vision One Workbench."
        DescriptionForModel: "Gets a list of security alerts from Trend Micro Vision One Workbench API. Supports filtering by time range, severity, status, or host."
        Inputs:
          - Name: startDateTime
            Description: "Start date/time in ISO 8601 format"
            Required: false
          - Name: endDateTime
            Description: "End date/time in ISO 8601 format"
            Required: false
          - Name: severity
            Description: "Alert severity"
            Required: false
          - Name: status
            Description: "Alert status"
            Required: false
          - Name: limit
            Description: "Maximum number of results to return"
            Required: false
            DefaultValue: "50"
        Settings:
          OperationHint: "GET /v3.0/workbench/alerts"

      - Name: GetWorkbenchAlertDetails
        Description: "Retrieve details for a specific Workbench alert."
        DescriptionForModel: "Gets full details for a specific alert from Trend Micro Vision One Workbench API."
        Inputs:
          - Name: alertId
            Description: "The unique ID of the alert"
            Required: true
        Settings:
          OperationHint: "GET /v3.0/workbench/alerts/{alertId}"

      - Name: ListEndpoints
        Description: "List endpoints from Trend Micro Endpoint Security."
        DescriptionForModel: "Retrieves a list of endpoints managed by Trend Micro Endpoint Security."
        Inputs:
          - Name: hostname
            Description: "Filter by endpoint hostname"
            Required: false
          - Name: os
            Description: "Filter by operating system"
            Required: false
          - Name: limit
            Description: "Maximum number of results to return"
            Required: false
            DefaultValue: "50"
        Settings:
          OperationHint: "GET /v3.0/endpoints"

      - Name: GetEndpointDetails
        Description: "Retrieve details for a specific endpoint."
        DescriptionForModel: "Gets full details for a specific endpoint managed by Trend Micro."
        Inputs:
          - Name: endpointId
            Description: "The unique ID of the endpoint"
            Required: true
        Settings:
          OperationHint: "GET /v3.0/endpoints/{endpointId}"
